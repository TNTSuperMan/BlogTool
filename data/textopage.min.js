let tmp=null,debug=!1;const e=function(e){return document.createElement(e)};function log(e){console.log(e)}function err(e){debug&&console.error(e)}function Get(e){let t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t}function LoadPage(t,n){for(let o=0;o<n.length;++o)switch(err(n[o]),n[o][0]){case":":let r=n[o].split(":");if(3!==r.length){err(o+1+" Line :xxx~ define is incorrect\n"+n[o]);continue}let i=e(r[1]);for(i.innerText=r[2];n.length-1>o&&0!==n[o+1].length&&"="===n[o+1][0]&&3===n[o+1].split("=").length;)o++,r=n[o].replace("\r","").split("="),i.setAttribute(r[1],r[2]);t.append(i);break;case";":let l=n[o].split(";");if(l.length<3){console.error(o+1+"Line text is incorrect\n"+n[o]);continue}let a=tmp.id.indexOf(l[1]);if(-1===a){err(o+1+" Line ;xxx~ define is incorrect\n"+n[o]);continue}let p=tmp.temp[a];for(let e=0;e<l.length-2;++e)p=p.replace("%",l[2+e]);LoadPage(t,p.split("\n"));break;case"<":t.innerHTML+=n[o]}}function outpage(t,n){let o=e(t);LoadPage(o,n),$(t).html(o.innerHTML)}function lm(t){if(404===t)return void lm(1);if(null==tmp){const t=$("body"),n=Get("/config/temp.json");if(200!==n.status)return void err("Not Found Template Configfile");tmp=JSON.parse(n.responseText),t.append(e("header")),t.append(e("main")),t.append(e("footer")),$("head").append(e("title"));let o=Get("/page/header.page");if(200!==o.status)return err("Not Found PageFile: header.page"),void lm(404);outpage("header",o.responseText.split("\n"));let r=Get("/page/footer.page");if(200!==r.status)return err("Not Found PageFile: footer.page"),void lm(404);outpage("footer",r.responseText.split("\n"))}const n="/page/"+t+".page";let o=Get(n);if(200!==o.status)return err("Not Found PageFile: "+n),void lm(404);const r=o.responseText.split("\n");$("main").text(null),$("title").text(r[0]),outpage("main",r),history.replaceState("","","?p="+t)}$((function(){var e=window.location.search,t=new Object;if(e)for(var n=(e=e.substring(1)).split("&"),o=0;o<n.length;o++){var r=n[o].split("="),i=decodeURIComponent(r[0]),l=decodeURIComponent(r[1]);t[i]=l}if(t.p){if(lm(t.p),t.s){const e=document.querySelector("#"+t.s);window.scrollTo(0,e.getBoundingClientRect().y)}}else lm(1)}));