let tmp=null,debug=!1;const e=function(e){return document.createElement(e)};function log(e){console.log(e)}function err(e){debug&&console.error(e)}function Get(e){let t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(),t}function LoadPage(t,n){for(let o=0;o<n.length;++o)switch(err(n[o]),n[o][0]){case":":let i=n[o].split(":");if(3!==i.length){err(o+1+" Line :xxx~ define is incorrect\n"+n[o]);continue}let r=e(i[1]);for(r.innerText=i[2];n.length-1>o&&0!==n[o+1].length&&"="===n[o+1][0]&&3===n[o+1].split("=").length;)o++,i=n[o].replace("\r","").split("="),r.setAttribute(i[1],i[2]);t.append(r);break;case";":let l=n[o].split(";");if(l.length<3){console.error(o+1+"Line text is incorrect\n"+n[o]);continue}let a=tmp.id.indexOf(l[1]);if(-1===a){err(o+1+" Line ;xxx~ define is incorrect\n"+n[o]);continue}let s=tmp.temp[a];for(let e=0;e<l.length-2;++e)s=s.replace("%",l[2+e]);LoadPage(t,s.split("\n"));break;case"<":t.innerHTML+=n[o]}}function outpage(t,n){let o=e(t);LoadPage(o,n),$(t).html(o.innerHTML)}function lm(t){if(null==tmp){const t=$("body"),n=Get("/config/temp.json");if(200!==n.status)return void err("Not Found Template Configfile");let o={id:[],temp:[]};JSON.parse(n.responseText).forEach((function(e){o.id.push(e.id),o.temp.push(e.base)})),tmp=o,t.append(e("header")),t.append(e("main")),t.append(e("footer")),$("head").append(e("title"));let i=Get("/page/header.page");if(200!==i.status)return err("Not Found PageFile: header.page"),void lm(404);outpage("header",i.responseText.split("\n"));let r=Get("/page/footer.page");if(200!==r.status)return err("Not Found PageFile: footer.page"),void lm(404);outpage("footer",r.responseText.split("\n"));const l=function(e){document.body.innerHTML+=e};l('<a href="#" id="dialogb63756">Powered by TextoPage.js</a>'),l('<div id="dialog29543" style="display:none" title="about: TextoPage.js">Powered by TextoPage.js<br><a target="_blank" href="https://github.com/TNTSuperMan/TextoPage.js">TextoPage.js Repository</a></div>')}const n="/page/"+t+".page";let o=Get(n);if(200!==o.status)return err("Not Found PageFile: "+n),void lm(404);const i=o.responseText.split("\n");$("main").text(null),$("title").text(i[0]),outpage("main",i),history.replaceState("","","?p="+t)}$((function(){var e=window.location.search,t=new Object;if(e)for(var n=(e=e.substring(1)).split("&"),o=0;o<n.length;o++){var i=n[o].split("="),r=decodeURIComponent(i[0]),l=decodeURIComponent(i[1]);t[r]=l}if(t.p){if(lm(t.p),t.s){const e=document.querySelector("#"+t.s);window.scrollTo(0,e.getBoundingClientRect().y)}}else lm(1);$("#dialogb63756").on("click",(function(){$("#dialog29543").dialog()}))}));